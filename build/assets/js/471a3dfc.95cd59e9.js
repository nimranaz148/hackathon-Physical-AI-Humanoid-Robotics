"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[690],{3710(e,n,r){r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"module1/week5-ros-fundamentals-3","title":"ROS 2 Packages and Launch Files","description":"Building ROS 2 packages with Python, launch files, and parameter management","source":"@site/docs/module1/week5-ros-fundamentals-3.md","sourceDirName":"module1","slug":"/module1/week5-ros-fundamentals-3","permalink":"/physical-ai-and-humanoid-robotics/docs/module1/week5-ros-fundamentals-3","draft":false,"unlisted":false,"editUrl":"https://github.com/nimranaz148/docs/module1/week5-ros-fundamentals-3.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"ROS 2 Packages and Launch Files","description":"Building ROS 2 packages with Python, launch files, and parameter management","keywords":["ros2","packages","launch","parameters","colcon"]},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Communication Patterns","permalink":"/physical-ai-and-humanoid-robotics/docs/module1/week4-ros-fundamentals-2"},"next":{"title":"Module 2: Gazebo & Unity","permalink":"/physical-ai-and-humanoid-robotics/docs/category/module-2-gazebo--unity"}}');var l=r(4848),i=r(8453);const t={sidebar_position:5,title:"ROS 2 Packages and Launch Files",description:"Building ROS 2 packages with Python, launch files, and parameter management",keywords:["ros2","packages","launch","parameters","colcon"]},o="Week 5: ROS 2 Packages and Launch Files",s={},c=[{value:"Learning Outcomes",id:"learning-outcomes",level:2},{value:"The Physics (Why)",id:"the-physics-why",level:2},{value:"The Analogy (Mental Model)",id:"the-analogy-mental-model",level:2},{value:"The Visualization (Package Structure)",id:"the-visualization-package-structure",level:2},{value:"The Code (Implementation)",id:"the-code-implementation",level:2},{value:"Package Structure",id:"package-structure",level:3},{value:"package.xml",id:"packagexml",level:3},{value:"setup.py",id:"setuppy",level:3},{value:"Launch File",id:"launch-file",level:3},{value:"Parameter YAML",id:"parameter-yaml",level:3},{value:"Node with Parameters",id:"node-with-parameters",level:3},{value:"Build and Run",id:"build-and-run",level:3},{value:"The Hardware Reality (Warning)",id:"the-hardware-reality-warning",level:2},{value:"Assessment",id:"assessment",level:2},{value:"Recall",id:"recall",level:3},{value:"Apply",id:"apply",level:3},{value:"Analyze",id:"analyze",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"week-5-ros-2-packages-and-launch-files",children:"Week 5: ROS 2 Packages and Launch Files"})}),"\n",(0,l.jsx)(n.h2,{id:"learning-outcomes",children:"Learning Outcomes"}),"\n",(0,l.jsx)(n.p,{children:"By the end of this chapter, you should be able to:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Create and build ROS 2 Python packages"}),"\n",(0,l.jsx)(n.li,{children:"Write launch files to start multiple nodes"}),"\n",(0,l.jsx)(n.li,{children:"Configure nodes with parameters and YAML files"}),"\n",(0,l.jsx)(n.li,{children:"Organize a complete robot software stack"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"the-physics-why",children:"The Physics (Why)"}),"\n",(0,l.jsxs)(n.p,{children:["A humanoid robot runs dozens of nodes simultaneously. Starting each manually is impractical. ",(0,l.jsx)(n.strong,{children:"Launch files"})," automate this process, while ",(0,l.jsx)(n.strong,{children:"packages"})," organize code into reusable modules."]}),"\n",(0,l.jsx)(n.h2,{id:"the-analogy-mental-model",children:"The Analogy (Mental Model)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Package"})," = A library or app (self-contained, reusable)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Launch file"})," = A startup script (orchestrates multiple programs)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Parameters"})," = Configuration settings (adjustable without recompiling)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"the-visualization-package-structure",children:"The Visualization (Package Structure)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-mermaid",children:'graph TB\r\n    subgraph "humanoid_robot Package"\r\n        A[package.xml] --\x3e B[Metadata]\r\n        C[setup.py] --\x3e D[Build Config]\r\n        E[humanoid_robot/] --\x3e F[Python Modules]\r\n        G[launch/] --\x3e H[Launch Files]\r\n        I[config/] --\x3e J[YAML Parameters]\r\n    end\n'})}),"\n",(0,l.jsx)(n.h2,{id:"the-code-implementation",children:"The Code (Implementation)"}),"\n",(0,l.jsx)(n.h3,{id:"package-structure",children:"Package Structure"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"humanoid_control/\r\n\u251c\u2500\u2500 package.xml              # Package metadata\r\n\u251c\u2500\u2500 setup.py                 # Python build configuration\r\n\u251c\u2500\u2500 setup.cfg                # Entry points config\r\n\u251c\u2500\u2500 resource/\r\n\u2502   \u2514\u2500\u2500 humanoid_control     # Marker file\r\n\u251c\u2500\u2500 humanoid_control/        # Python package\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 balance_controller.py\r\n\u2502   \u251c\u2500\u2500 gait_generator.py\r\n\u2502   \u2514\u2500\u2500 safety_monitor.py\r\n\u251c\u2500\u2500 launch/\r\n\u2502   \u2514\u2500\u2500 humanoid_bringup.launch.py\r\n\u2514\u2500\u2500 config/\r\n    \u2514\u2500\u2500 robot_params.yaml\n"})}),"\n",(0,l.jsx)(n.h3,{id:"packagexml",children:"package.xml"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<package format="3">\r\n  <name>humanoid_control</name>\r\n  <version>1.0.0</version>\r\n  <description>Humanoid robot control package</description>\r\n  <maintainer email="dev@example.com">Developer</maintainer>\r\n  <license>MIT</license>\r\n\r\n  <depend>rclpy</depend>\r\n  <depend>std_msgs</depend>\r\n  <depend>geometry_msgs</depend>\r\n  <depend>sensor_msgs</depend>\r\n\r\n  <export>\r\n    <build_type>ament_python</build_type>\r\n  </export>\r\n</package>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"setuppy",children:"setup.py"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\r\nimport os\r\nfrom glob import glob\r\n\r\npackage_name = 'humanoid_control'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='1.0.0',\r\n    packages=[package_name],\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n        (os.path.join('share', package_name, 'launch'),\r\n            glob('launch/*.launch.py')),\r\n        (os.path.join('share', package_name, 'config'),\r\n            glob('config/*.yaml')),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'balance_controller = humanoid_control.balance_controller:main',\r\n            'gait_generator = humanoid_control.gait_generator:main',\r\n            'safety_monitor = humanoid_control.safety_monitor:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"launch-file",children:"Launch File"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n\"\"\"\r\nhumanoid_bringup.launch.py - Launch all humanoid control nodes.\r\n\"\"\"\r\n\r\nfrom launch import LaunchDescription\r\nfrom launch_ros.actions import Node\r\nfrom launch.actions import DeclareLaunchArgument\r\nfrom launch.substitutions import LaunchConfiguration\r\nfrom ament_index_python.packages import get_package_share_directory\r\nimport os\r\n\r\n\r\ndef generate_launch_description():\r\n    # Get package directory\r\n    pkg_dir = get_package_share_directory('humanoid_control')\r\n    \r\n    # Declare arguments\r\n    use_sim = DeclareLaunchArgument(\r\n        'use_sim',\r\n        default_value='true',\r\n        description='Use simulation time'\r\n    )\r\n    \r\n    # Load parameters\r\n    params_file = os.path.join(pkg_dir, 'config', 'robot_params.yaml')\r\n    \r\n    # Define nodes\r\n    balance_node = Node(\r\n        package='humanoid_control',\r\n        executable='balance_controller',\r\n        name='balance_controller',\r\n        parameters=[params_file, {'use_sim_time': LaunchConfiguration('use_sim')}],\r\n        output='screen'\r\n    )\r\n    \r\n    gait_node = Node(\r\n        package='humanoid_control',\r\n        executable='gait_generator',\r\n        name='gait_generator',\r\n        parameters=[params_file],\r\n        output='screen'\r\n    )\r\n    \r\n    safety_node = Node(\r\n        package='humanoid_control',\r\n        executable='safety_monitor',\r\n        name='safety_monitor',\r\n        parameters=[{'max_tilt': 0.5, 'max_force': 100.0}],\r\n        output='screen'\r\n    )\r\n    \r\n    return LaunchDescription([\r\n        use_sim,\r\n        balance_node,\r\n        gait_node,\r\n        safety_node,\r\n    ])\n"})}),"\n",(0,l.jsx)(n.h3,{id:"parameter-yaml",children:"Parameter YAML"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# robot_params.yaml\r\nbalance_controller:\r\n  ros__parameters:\r\n    control_frequency: 1000.0  # Hz\r\n    kp_roll: 100.0\r\n    kd_roll: 10.0\r\n    kp_pitch: 100.0\r\n    kd_pitch: 10.0\r\n    max_correction: 0.1  # radians\r\n\r\ngait_generator:\r\n  ros__parameters:\r\n    step_height: 0.05  # meters\r\n    step_length: 0.3   # meters\r\n    cycle_time: 0.8    # seconds\r\n    double_support_ratio: 0.2\n"})}),"\n",(0,l.jsx)(n.h3,{id:"node-with-parameters",children:"Node with Parameters"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\r\n\"\"\"\r\nbalance_controller.py - Uses parameters from YAML.\r\n\"\"\"\r\n\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom rcl_interfaces.msg import ParameterDescriptor\r\n\r\n\r\nclass BalanceController(Node):\r\n    def __init__(self):\r\n        super().__init__('balance_controller')\r\n        \r\n        # Declare parameters with descriptions\r\n        self.declare_parameter(\r\n            'control_frequency',\r\n            1000.0,\r\n            ParameterDescriptor(description='Control loop frequency in Hz')\r\n        )\r\n        self.declare_parameter('kp_roll', 100.0)\r\n        self.declare_parameter('kd_roll', 10.0)\r\n        \r\n        # Get parameter values\r\n        freq = self.get_parameter('control_frequency').value\r\n        self.kp = self.get_parameter('kp_roll').value\r\n        self.kd = self.get_parameter('kd_roll').value\r\n        \r\n        # Create timer at specified frequency\r\n        period = 1.0 / freq\r\n        self.timer = self.create_timer(period, self.control_loop)\r\n        \r\n        self.get_logger().info(\r\n            f'Balance controller started at {freq} Hz, Kp={self.kp}, Kd={self.kd}'\r\n        )\r\n    \r\n    def control_loop(self):\r\n        # Control logic here\r\n        pass\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = BalanceController()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,l.jsx)(n.h3,{id:"build-and-run",children:"Build and Run"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Build the package\r\ncd ~/ros2_ws\r\ncolcon build --packages-select humanoid_control\r\n\r\n# Source the workspace\r\nsource install/setup.bash\r\n\r\n# Launch all nodes\r\nros2 launch humanoid_control humanoid_bringup.launch.py\r\n\r\n# Launch with arguments\r\nros2 launch humanoid_control humanoid_bringup.launch.py use_sim:=false\r\n\r\n# Change parameters at runtime\r\nros2 param set /balance_controller kp_roll 150.0\n"})}),"\n",(0,l.jsx)(n.h2,{id:"the-hardware-reality-warning",children:"The Hardware Reality (Warning)"}),"\n",(0,l.jsx)(n.admonition,{title:"Build Dependencies",type:"warning",children:(0,l.jsxs)(n.p,{children:["Always declare all dependencies in ",(0,l.jsx)(n.code,{children:"package.xml"}),". Missing dependencies cause cryptic build failures on other machines."]})}),"\n",(0,l.jsx)(n.admonition,{title:"Parameter Best Practices",type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Use YAML files for complex configurations"}),"\n",(0,l.jsx)(n.li,{children:"Declare all parameters with descriptors"}),"\n",(0,l.jsx)(n.li,{children:"Provide sensible defaults"}),"\n",(0,l.jsx)(n.li,{children:"Document units in parameter names or descriptions"}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"assessment",children:"Assessment"}),"\n",(0,l.jsx)(n.h3,{id:"recall",children:"Recall"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"What files are required in a ROS 2 Python package?"}),"\n",(0,l.jsx)(n.li,{children:"How do you pass parameters to a node in a launch file?"}),"\n",(0,l.jsx)(n.li,{children:"What command builds a specific package?"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"apply",children:"Apply"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Create a package with two nodes that communicate via a topic."}),"\n",(0,l.jsx)(n.li,{children:"Write a launch file that starts nodes with different parameter files for simulation vs. real robot."}),"\n",(0,l.jsx)(n.li,{children:"Implement dynamic parameter updates that take effect without restarting the node."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"analyze",children:"Analyze"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"How would you organize packages for a humanoid robot with arms, legs, and a head?"}),"\n",(0,l.jsx)(n.li,{children:"What are the trade-offs between hardcoded values vs. parameters?"}),"\n",(0,l.jsx)(n.li,{children:"Design a parameter hierarchy for a robot with multiple operating modes (walking, running, climbing)."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>t,x:()=>o});var a=r(6540);const l={},i=a.createContext(l);function t(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);